# Story 1.3: Integrate and Configure SQLite with Prisma

## Status

Draft

## Story

**As a** Developer,
**I want** to integrate SQLite into the Remix application using Prisma,
**so that** the application has a configured database layer to persist data.

## Acceptance Criteria

1. SQLite e Prisma são adicionados como dependências.
2. Prisma é inicializado e configurado para usar o provider SQLite.
3. Um schema Prisma inicial é criado.
4. O comando `prisma migrate dev` executa com sucesso.
5. O Prisma Client pode ser utilizado na aplicação Remix.

## Tasks / Subtasks

- [ ] Task 1 (AC: 1, 2)
  - [ ] Install Prisma CLI and Prisma Client as dependencies in apps/web
  - [ ] Install SQLite as dependency 
  - [ ] Initialize Prisma in apps/web directory with `prisma init`
  - [ ] Configure prisma/schema.prisma to use SQLite provider with DATABASE_URL
- [ ] Task 2 (AC: 3)
  - [ ] Create initial User model schema as specified in database-schema.md
  - [ ] Configure Prisma Client generator in schema.prisma
- [ ] Task 3 (AC: 4)
  - [ ] Create initial migration with `prisma migrate dev`
  - [ ] Verify migration executes successfully and creates SQLite database
- [ ] Task 4 (AC: 5)
  - [ ] Set up Prisma Client singleton in apps/web/app/lib/prisma.ts
  - [ ] Create example service that uses Prisma Client to verify integration
- [ ] Task 5: Testing
  - [ ] Create unit tests for Prisma Client integration using Vitest
  - [ ] Test database connection and basic CRUD operations
  - [ ] Verify test database isolation

## Dev Notes

### Previous Story Insights

- Monorepo structure com npm workspaces foi criada [Source: Previous Story 1.1]
- Remix aplicação configurada em `apps/web` com TypeScript 5.8 [Source: Previous Story 1.1]
- ESLint e Prettier configurados ao nível do monorepo [Source: Previous Story 1.2]
- Node.js 22.x sendo usado [Source: Previous Story 1.1]

### Data Models

- **User Model**: Único modelo no banco de dados SQLite [Source: architecture/data-models-revised.md]
- User interface: id (string), email (string), createdAt (Date), updatedAt (Date) [Source: architecture/data-models-revised.md]
- Prisma schema deve usar provider SQLite e cuid() para IDs [Source: architecture/database-schema.md]

### API Specifications

No specific guidance found in architecture docs

### Component Specifications

No specific guidance found in architecture docs

### File Locations

- **Prisma Directory**: `apps/web/prisma/` [Source: architecture/source-tree.md]
- **Prisma Client**: `apps/web/app/lib/` [Source: architecture/source-tree.md]
- **Services**: `apps/web/app/services/` para lógica de negócio [Source: architecture/source-tree.md]
- **Shared Types**: `packages/shared-types/` para interfaces TypeScript [Source: architecture/source-tree.md]

### Technical Constraints

- **ORM**: Prisma 6.x [Source: architecture/tech-stack.md]
- **Banco de Dados**: SQLite ~5.x [Source: architecture/tech-stack.md]
- **Language/Runtime**: TypeScript 5.8, Node.js 22.x [Source: architecture/coding-standards.md]
- **Environment Variables**: Acesso apenas através de módulo de config central tipado [Source: architecture/coding-standards.md]
- **Shared Types**: Todos os tipos compartilhados devem estar em packages/shared-types [Source: architecture/coding-standards.md]
- **Service Layer**: Toda lógica de negócio backend deve estar em apps/web/app/services/ [Source: architecture/coding-standards.md]

### Testing

- **Test Files**: Use a convenção `*.test.tsx` ou `*.test.ts` [Source: architecture/coding-standards.md]
- **Unit Tests (Vitest)**: Para testes isolados de serviços, componentes e funções utilitárias [Source: architecture/test-strategy.md]
- **Integration Tests (Vitest)**: Para testar fluxo completo de rotas Remix [Source: architecture/test-strategy.md]
- **Coverage**: Apontar para >80% de cobertura na lógica de negócio crítica [Source: architecture/test-strategy.md]
- **Test Data Management**: Script de seed do Prisma será usado para popular banco de teste [Source: architecture/test-strategy.md]

### Project Structure Notes

A estrutura do projeto alinha com os requisitos da história:
- Prisma será configurado em `apps/web/prisma/` conforme source-tree.md
- Prisma Client será criado em `apps/web/app/lib/` conforme padrões de arquitetura
- Types do User serão definidos em `packages/shared-types/` conforme coding standards

## Change Log

| Date       | Version | Description   | Author             |
| ---------- | ------- | ------------- | ------------------ |
| 2025-07-22 | 1.0     | Initial draft | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used

_Pendente - será preenchido pelo agente de desenvolvimento_

### Debug Log References

_Pendente - será preenchido pelo agente de desenvolvimento_

### Completion Notes List

_Pendente - será preenchido pelo agente de desenvolvimento_

### File List

_Pendente - será preenchido pelo agente de desenvolvimento_

## QA Results

_Pendente - será preenchido pelo agente de QA_